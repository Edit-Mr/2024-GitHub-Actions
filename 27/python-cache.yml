name: Python CI with Cache

   on:
     push:
       branches:
         - main
     pull_request:

   jobs:
     build:
       runs-on: ubuntu-latest

       steps:
         - name: Checkout code
           uses: actions/checkout@v3

         - name: Set up Python
           uses: actions/setup-python@v4
           with:
             python-version: '3.10'

         - name: Cache Python packages
           uses: actions/cache@v3
           with:
             path: ~/.cache/pip
             key: ${{ runner.os }}-python-${{ hashFiles('**/requirements.txt') }}
             restore-keys: |
               ${{ runner.os }}-python-

         - name: Install dependencies
           run: pip install -r requirements.txt

         - name: Run tests
           run: pytest